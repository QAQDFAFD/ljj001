# 加载状态设计

## 🎯 三种加载状态

### 1. **思考阶段** - 旋转圈 + 文字
- **时机**：用户点击发送后，等待后端响应
- **显示**：`🤖 [旋转圈] 正在思考中...`
- **代码**：`message.id === 'loading'`

### 2. **等待首字符** - 跳动省略号
- **时机**：后端开始响应，但还没收到第一个字符
- **显示**：`🤖 . . .` (三个点跳动)
- **代码**：`message.role === 'assistant' && message.content === ''`

### 3. **流式输出** - 打字机效果
- **时机**：收到第一个字符后，逐字显示
- **显示**：`🤖 正在逐字显示内容...`
- **代码**：`message.content.length > 0`

## 🎨 视觉效果

```
用户发送消息
    ↓
🤖 [旋转圈] 正在思考中...    ← 等待后端响应
    ↓
🤖 . . .                    ← 等待第一个字符 (跳动)
    ↓
🤖 你...                     ← 开始流式显示
🤖 你好...
🤖 你好！我...
🤖 你好！我是AI助手...       ← 完整内容
```

## 🔧 CSS 动画

### **跳动省略号**
```css
.waiting-dots span {
  animation: bounce-dots 1.4s infinite;
  transform: translateY(-8px); /* 向上跳跃 */
}
```

### **时间间隔**
- **跳跃动画**：1.4秒循环
- **延迟间隔**：每个点延迟 0.2秒
- **批量更新**：50ms 合并多个 chunks

## 🎭 用户体验

### **优势**
- ✅ **状态清晰**：用户知道当前处于哪个阶段
- ✅ **视觉反馈**：不同阶段有不同的动画效果
- ✅ **性能优化**：批量更新减少渲染频率
- ✅ **无缝切换**：从跳动点到文字内容的流畅过渡

### **时间线**
1. **0ms**: 用户点击发送
2. **100-500ms**: 显示思考动画
3. **500-1000ms**: 显示跳动省略号
4. **1000ms+**: 开始流式显示内容

## 🔍 调试信息

### **控制台日志**
```javascript
// 第一个字符到达
console.log('First chunk received, hiding dots animation')

// 每个数据块
console.log('Received chunk:', chunk)

// 流式完成
console.log('Stream completed')
```

### **状态检查**
- 打开浏览器开发者工具
- 观察 Console 中的日志
- 确认状态切换是否正确
